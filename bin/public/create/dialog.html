<md-dialog ng-cloak style="width: 100%">
  <md-toolbar>
    <div class="md-toolbar-tools">
      <h2>Proxy Settings</h2>
      <span flex></span>
      <md-button class="md-icon-button" ng-click="cancel()">X</md-button>
    </div>
  </md-toolbar>
  <md-dialog-content>
    <form ng-sumbit=submit()>
      <md-tabs class=proxies-tabs md-dynamic-height md-border-bottom>
        <md-tab label=general>
          <md-content>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>Port</label>
                <input type=number ng-model=form.port md-autofocus
                  placeholder={{consts.port.def}} min=24000>
              </md-input-container>
              <md-input-container class=md-block flex-gt-sm>
                <label>Interface</label>
                <md-select ng-model=form.iface>
                  <md-option ng-repeat="c in consts.iface.values">
                    {{c}}
                  </md-option>
                </md-select>
              </md-input-container>
            </div>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>Zone</label>
                <input ng-model=form.zone placeholder={{consts.zone.def}}>
              </md-input-container>
              <md-input-container class=md-block flex-gt-sm>
                <label>Zone password</label>
                <input ng-model=form.password>
                <div class=hint>If different from zone</div>
              </md-input-container>
            </div>
          </md-content>
        </md-tab>
        <md-tab label=targeting>
          <md-content>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>Country</label>
                <md-select ng-model=form.country>
                  <md-option ng-repeat="c in consts.country.values"
                    ng-value=c.value>
                    {{c.key}}
                  </md-option>
                </md-select>
              </md-input-container>
            </div>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>State</label>
                <input ng-model=form.state placeholder=ny>
              </md-input-container>
              <md-input-container class=md-block flex-gt-sm>
                <label>City</label>
                <input ng-model=form.city placeholder=new_york>
              </md-input-container>
            </div>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>{{consts.asn.desc}}</label>
                <input type=number ng-model=form.asn>
                <a href="http://bgp.potaroo.net/cidr/autnums.html"
                  target=_blank style="position: relative; top: 0.2em">
                  ASN list
                </a>
              </md-input-container>
            </div>
          </md-content>
        </md-tab>
        <md-tab label=perfomance>
          <md-content>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>Session timeout</label>
                <input type=number ng-model=form.session_timeout
                  placeholder={{consts.session_timeout.def}}>
              </md-input-container>
              <md-input-container class=md-block flex-gt-sm>
                <label>Minimum proxies count</label>
                <input type=number ng-model=form.proxy_count
                  placeholder={{consts.proxy_count.def}}>
              </md-input-container>
              <md-input-container class=md-block flex-gt-sm>
                <label>Pool size</label>
                <input type=number ng-model=form.pool_size
                  placeholder={{consts.pool_size.def}}>
              </md-input-container>
              <md-input-container class=md-block flex-gt-sm>
                <label>Max requests</label>
                <input type=number ng-model=form.max_requests
                  placeholder={{consts.max_requests.def}}>
              </md-input-container>
            </div>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>Dns resolve</label>
                <md-select ng-model="form.dns">
                  <md-option ng-repeat="c in consts.dns.values">
                    {{c}}
                  </md-option>
                </md-select>
              </md-input-container>
              <md-input-container class=md-block flex-gt-sm>
                <label>Log level
                  {{form.log ? '' : '('+consts.log.def+' by default)'}}
                </label>
                <md-select ng-model=form.log>
                  <md-option ng-repeat="c in consts.log.values">
                    {{c}}
                  </md-option>
                </md-select>
              </md-input-container>
            </div>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>{{consts.proxy_switch.desc}}</label>
                <input type=number ng-model=form.proxy_switch
                  placeholder={{consts.proxy_switch.def}}>
              </md-input-container>
              <md-input-container class=md-block flex-gt-sm>
                <md-checkbox ng-model=form.sticky_ip>Sticky ip</md-checkbox>
                <span class="hint hidden">Same IP as much as possible</span>
              </md-input-container>
            </div>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>{{consts.timeout.desc}}</label>
                <input type=number ng-model=form.timeout
                  placeholder={{consts.timeout.def}}>
              </md-input-container>
              <md-input-container class=md-block flex-gt-sm>
                <label>{{consts.proxy.desc}}</label>
                <input ng-model=form.proxy>
                <div class=hidden>{{consts.proxy.desc}}</div>
              </md-input-container>
            </div>
          </md-content>
        </md-tab>
        <md-tab label="Special urls">
          <md-content>
            <p>You can use
              <a href="https://en.wikipedia.org/wiki/Regular_expression"
                  target=_blank>
                regular expressions
              </a> for url patterns.
            </p>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>Direct include</label>
                <input ng-model=form.direct.include>
                <div class=hint>
                  {{consts.direct_include.desc}}
                </div>
              </md-input-container>
            </div>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>Direct exclude</label>
                <input ng-model=form.direct.exclude>
                <div class=hint>
                  {{consts.direct_exclude.desc}}
                </div>
              </md-input-container>
            </div>
            <div layout-gt-sm=row>
              <md-input-container class=md-block flex-gt-sm>
                <label>Null response</label>
                <input ng-model=form.null_response>
                <div class=hint>
                  {{consts.null_response.desc}}
                </div>
              </md-input-container>
            </div>
          </md-content>
        </md-tab>
      </md-tabs>
    </form>
      <!--
        <div class="form-group hidden">
          <div class="col-sm-offset-2 col-sm-10">
            <div class=checkbox>
              <label><input type=checkbox ng-model=form.history>history</label>
            </div>
          </div>
        </div>
        <div class="form-group hidden">
          <div class="col-sm-offset-2 col-sm-10">
            <div class=checkbox>
              <label><input type=checkbox ng-disabled=!form.history ng-model=form_data.ssl>ssl</label>
            </div>
          </div>
        </div>
      -->
  </md-dialog-content>
  <md-dialog-actions layout=row>
    <span flex></span>
    <md-button ng-click="cancel()">
      Cancel
    </md-button>
    <md-button ng-click="validate(form)" style="margin-right:20px;">
      Save
    </md-button>
  </md-dialog-actions>
</md-dialog>
